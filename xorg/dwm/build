#!/bin/sh -e

# new windows will spawn at the bottom of the stack
patch -p1 < dwm-attachasideandbelow-20200702-f04cac6.diff

# Remove pixel gap.
sed "s/static const int resizehints = 1/static const int resizehints = 0/" \
    config.def.h > _
mv -f _ config.def.h

# change the border color
sed 's/005577/ff950e/' config.def.h > _
mv -f _ config.def.h

# remove bar
sed 's/showbar *= 1/showbar = 0/' config.def.h > _
mv -f _ config.def.h

# drop Xinerama dep
sed 's/XINERAMALIBS/#XINERAMALIBS/' config.mk > _
mv -f _ config.mk
sed 's/XINERAMAFLAGS/#XINERAMAFLAGS/' config.mk > _
mv -f _ config.mk


# last has to be a wildcard, otherwise itll fail, and complain about references
# in functions. however, the lib in question, does not seem to exist.
# Atleast I cant find it after searching up every reference with theire
# respective library. If you happen to know it, let me know.
make \
    LDFLAGS="$LDFLAGS -static /usr/lib/libX11.a /usr/lib/libxcb.a \
    /usr/lib/libXau.a /usr/lib/libXmu.a /usr/lib/libXft.a \
    /usr/lib/libfontconfig.a /usr/lib/libfreetype.a /usr/lib/libXrender.a \
    /usr/lib/libexpat.a /usr/lib/libpng.a /usr/lib/libz.a \
    /usr/lib/*.a"
make PREFIX=/usr install
