#!/bin/sh

umask 022

svc -k 1> /dev/null

kill 1
sleep 1
kill -s KILL 1

swapoff -a

mount -o remount,ro /
sync
sleep 1

umount -al

wait

case $1 in
  reboot) halt -r ;;
  poweroff) halt -p ;;
  *) echo "Invalid action for rc.shutdown" && exit 1 ;;
esac
